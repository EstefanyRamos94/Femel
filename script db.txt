# Ejecutar este script en el motor de la base de datos:

drop trigger actsolicitud;

DELIMITER $$
CREATE TRIGGER actsolicitud
AFTER INSERT ON femel.fondo_detallesolicitudes
FOR EACH ROW
BEGIN
	if femel.fondo_detallesolicitudes.valor_aprobado <= 1000 then
		UPDATE femel.fondo_solicitudcredito inner join fondo_detallesolicitudes
		set fondo_solicitudcredito.estado_solicitud = 'Rechazada'
		where fondo_detallesolicitudes.solicitud_id = fondo_solicitudcredito.id;
	else 
		UPDATE femel.fondo_solicitudcredito inner join fondo_detallesolicitudes
		set fondo_solicitudcredito.estado_solicitud = 'Aceptada'
		where fondo_detallesolicitudes.solicitud_id = fondo_solicitudcredito.id;
	end if;
END$$
DELIMITER ;

DELIMITER $$
CREATE TRIGGER actsolicitudupdate
AFTER UPDATE ON femel.fondo_detallesolicitudes
FOR EACH ROW
BEGIN
	if femel.fondo_detallesolicitudes.valor_aprobado <= 1000 then
		UPDATE femel.fondo_solicitudcredito inner join fondo_detallesolicitudes
		set fondo_solicitudcredito.estado_solicitud = 'Rechazada'
		where fondo_detallesolicitudes.solicitud_id = fondo_solicitudcredito.id;
	else 
		UPDATE femel.fondo_solicitudcredito inner join fondo_detallesolicitudes
		set fondo_solicitudcredito.estado_solicitud = 'Aceptada'
		where fondo_detallesolicitudes.solicitud_id = fondo_solicitudcredito.id;
	end if;
END$$
DELIMITER ;